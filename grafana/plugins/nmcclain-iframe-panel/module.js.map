{"version":3,"file":"module.js","mappings":";2IAAAA,EAAOC,QAAUC,C,UCAjBF,EAAOC,QAAUE,C,UCAjBH,EAAOC,QAAUG,C,QCAjBJ,EAAOC,QAAUI,C,UCAjBL,EAAOC,QAAUK,C,UCAjBN,EAAOC,QAAUM,C,GCCbC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaV,QAGrB,IAAID,EAASQ,EAAyBE,GAAY,CAGjDT,QAAS,CAAC,GAOX,OAHAY,EAAoBH,GAAUV,EAAQA,EAAOC,QAASQ,GAG/CT,EAAOC,OACf,CCrBAQ,EAAoBK,EAAKd,IACxB,IAAIe,EAASf,GAAUA,EAAOgB,WAC7B,IAAOhB,EAAiB,QACxB,IAAM,EAEP,OADAS,EAAoBQ,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdN,EAAoBQ,EAAI,CAAChB,EAASkB,KACjC,IAAI,IAAIC,KAAOD,EACXV,EAAoBY,EAAEF,EAAYC,KAASX,EAAoBY,EAAEpB,EAASmB,IAC5EE,OAAOC,eAAetB,EAASmB,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDX,EAAoBY,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFlB,EAAoBsB,EAAK9B,IACH,oBAAX+B,QAA0BA,OAAOC,aAC1CX,OAAOC,eAAetB,EAAS+B,OAAOC,YAAa,CAAEC,MAAO,WAE7DZ,OAAOC,eAAetB,EAAS,aAAc,CAAEiC,OAAO,GAAO,ECL9DzB,EAAoB0B,EAAI,wC,4DCGxB,IACE,KAAiB,QACb,QAAkBC,MAAM,EAAG,QAAkBC,YAAY,KAAO,GAChE,wC,uDCGN,MAAMC,EAAY,KACT,CACLC,QAASC,EAAAA,GAAG;;;;MAKZC,OAAQD,EAAAA,GAAG;;;;;;;;;6BAqB6B,EAAGE,UAASC,QAAOC,SAAQC,uBACrE,MAAMC,GAASC,EAAAA,EAAAA,YAAWT,IACnBU,EAAYC,IAAiBC,EAAAA,EAAAA,WAAS,GACvCC,GAAmBC,EAAAA,EAAAA,QAA8B,MAqBvD,IAnBAC,EAAAA,EAAAA,YAAU,KAERJ,GAAc,GAEVE,EAAiBG,SACnBC,aAAaJ,EAAiBG,SAGhCH,EAAiBG,QAAUE,YAAW,KACpCP,GAAc,EAAM,GACnB,KAEI,KACDE,EAAiBG,SACnBC,aAAaJ,EAAiBG,QAChC,IAED,CAACX,EAAOC,KAENF,IAAYA,EAAQe,IACvB,OACE,kBAACC,MAAAA,CAAIC,UAAWb,EAAOP,SACrB,kBAACmB,MAAAA,KAAI,gDAKX,MAAME,EAAclB,EAAQkB,aAAe,EACrCC,EAAclB,GAAS,EAAIiB,GAC3BE,EAAelB,GAAU,EAAIgB,GAGnC,IAAIG,EAASlB,EAAiBH,EAAQe,KAGtC,MAAMO,EAhDe,CAACC,IACtB,MAAMC,EAAQD,EAAKE,MAAM,KACzB,OAAID,EAAME,QAAU,EACXF,EAAM,GAER,EAAE,EA2CIG,CAAeC,EAAAA,gBAAgBC,cAAcC,UAI1D,OAFAT,GADWU,EAAAA,EAAAA,kBACCC,QAAQX,EAAQ,CAAEY,YAAa,CAAEzC,MAAO8B,KAGlD,kBAACN,MAAAA,CACCC,WAAWiB,EAAAA,EAAAA,IACT9B,EAAOP,QACPC,EAAAA,GAAG;mBACQG;oBACCC;YAId,kBAACH,SAAAA,CACCoC,MAAM,SACNpB,IAAKM,EACLJ,WAAWiB,EAAAA,EAAAA,IACT9B,EAAOL,OACPD,EAAAA,GAAG;8BACiBQ,GAAcN,EAAQoC,qBAAuB,OAAS;qBAC/DjB;sBACCC;+BACSF","sources":["webpack://nmcclain-iframe-panel/external amd \"@emotion/css\"","webpack://nmcclain-iframe-panel/external amd \"@grafana/data\"","webpack://nmcclain-iframe-panel/external amd \"@grafana/runtime\"","webpack://nmcclain-iframe-panel/external amd \"@grafana/ui\"","webpack://nmcclain-iframe-panel/external amd \"module\"","webpack://nmcclain-iframe-panel/external amd \"react\"","webpack://nmcclain-iframe-panel/webpack/bootstrap","webpack://nmcclain-iframe-panel/webpack/runtime/compat get default export","webpack://nmcclain-iframe-panel/webpack/runtime/define property getters","webpack://nmcclain-iframe-panel/webpack/runtime/hasOwnProperty shorthand","webpack://nmcclain-iframe-panel/webpack/runtime/make namespace object","webpack://nmcclain-iframe-panel/webpack/runtime/publicPath","webpack://nmcclain-iframe-panel/./node_modules/grafana-public-path.js","webpack://nmcclain-iframe-panel/./components/IframePanel.tsx"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__89__;","module.exports = __WEBPACK_EXTERNAL_MODULE__781__;","module.exports = __WEBPACK_EXTERNAL_MODULE__531__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__308__;","module.exports = __WEBPACK_EXTERNAL_MODULE__959__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"public/plugins/nmcclain-iframe-panel/\";","\nimport amdMetaModule from 'amd-module';\n\n__webpack_public_path__ =\n  amdMetaModule && amdMetaModule.uri\n    ? amdMetaModule.uri.slice(0, amdMetaModule.uri.lastIndexOf('/') + 1)\n    : 'public/plugins/nmcclain-iframe-panel/';\n","import React, { useState, useEffect, useRef } from 'react';\nimport { PanelProps } from '@grafana/data';\nimport { locationService, getTemplateSrv } from '@grafana/runtime';\nimport { IframeOptions } from 'types';\nimport { css, cx } from '@emotion/css';\nimport { useStyles2 } from '@grafana/ui';\n\ninterface Props extends PanelProps<IframeOptions> {}\n\nconst getStyles = () => {\n  return {\n    wrapper: css`\n      font-family: Open Sans, sans-serif;\n      overflow: hidden;\n      position: relative;\n    `,\n    iframe: css`\n      position: absolute;\n      overflow: hidden;\n      top: 0;\n      left: 0;\n      frameborder: 0;\n      display: block;\n      transform-origin: 0 0;\n      allow: 'accelerometer; encrypted-media;' allowfullscreen;\n    `,\n  };\n};\n\nconst getDashboardID = (path: string): string => {\n  const parts = path.split('/');\n  if (parts.length >= 3) {\n    return parts[2]; // The dashboard id is at index 2 (/d/DASHID/dash-slug)\n  }\n  return '';\n};\n\nexport const IframePanel: React.FC<Props> = ({ options, width, height, replaceVariables }) => {\n  const styles = useStyles2(getStyles);\n  const [isResizing, setIsResizing] = useState(false);\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    // prevents iframe from interfering with resizing\n    setIsResizing(true);\n\n    if (resizeTimeoutRef.current) {\n      clearTimeout(resizeTimeoutRef.current);\n    }\n\n    resizeTimeoutRef.current = setTimeout(() => {\n      setIsResizing(false);\n    }, 100);\n\n    return () => {\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, [width, height]);\n\n  if (!options || !options.src) {\n    return (\n      <div className={styles.wrapper}>\n        <div>Please provide a source URL for the IFrame.</div>\n      </div>\n    );\n  }\n\n  const scaleFactor = options.scaleFactor || 1;\n  const scaledWidth = width * (1 / scaleFactor);\n  const scaledHeight = height * (1 / scaleFactor);\n\n  // interpolate the dashboard variables on the src URL\n  let srcUrl = replaceVariables(options.src);\n\n  // interpolate the special $iframe_dbid template variable on the src URL\n  const dbID = getDashboardID(locationService.getLocation().pathname);\n  const ts = getTemplateSrv();\n  srcUrl = ts.replace(srcUrl, { iframe_dbid: { value: dbID } });\n\n  return (\n    <div\n      className={cx(\n        styles.wrapper,\n        css`\n          width: ${width}px;\n          height: ${height}px;\n        `\n      )}\n    >\n      <iframe\n        title=\"IFrame\"\n        src={srcUrl}\n        className={cx(\n          styles.iframe,\n          css`\n            pointer-events: ${isResizing || options.disableInteractivity ? 'none' : 'auto'};\n            width: ${scaledWidth}px;\n            height: ${scaledHeight}px;\n            transform: scale(${scaleFactor});\n          `\n        )}\n      ></iframe>\n    </div>\n  );\n};\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE__89__","__WEBPACK_EXTERNAL_MODULE__781__","__WEBPACK_EXTERNAL_MODULE__531__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__308__","__WEBPACK_EXTERNAL_MODULE__959__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","p","slice","lastIndexOf","getStyles","wrapper","css","iframe","options","width","height","replaceVariables","styles","useStyles2","isResizing","setIsResizing","useState","resizeTimeoutRef","useRef","useEffect","current","clearTimeout","setTimeout","src","div","className","scaleFactor","scaledWidth","scaledHeight","srcUrl","dbID","path","parts","split","length","getDashboardID","locationService","getLocation","pathname","getTemplateSrv","replace","iframe_dbid","cx","title","disableInteractivity"],"sourceRoot":""}